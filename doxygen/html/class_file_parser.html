<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>WinWipe: FileParser Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WinWipe
   </div>
   <div id="projectbrief">Windows File, Folder, Registry, Service and Process Wiper</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="class_file_parser-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FileParser Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_file_parser_8h_source.html">FileParser.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8b41aca52b30e9f357f50e76f3c9cc9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a8b41aca52b30e9f357f50e76f3c9cc9d">~FileParser</a> ()</td></tr>
<tr class="separator:a8b41aca52b30e9f357f50e76f3c9cc9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9afb1f972834a822ee7f24d34281a3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile</a> (<a class="el" href="_file_parser_8h.html#a77516d1e52649fa212cc16893769cf63">E_FILE_TYPE</a> filetype, const char *filepath)</td></tr>
<tr class="separator:a5e9afb1f972834a822ee7f24d34281a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a24e4c684b9ae137492fdcb5d1e14b277"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a24e4c684b9ae137492fdcb5d1e14b277">NO_CLASS_ASSIGNMENT</a> (<a class="el" href="class_file_parser.html">FileParser</a>)</td></tr>
<tr class="separator:a24e4c684b9ae137492fdcb5d1e14b277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22508ba901abdc8352b6ddb5465d389"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#aa22508ba901abdc8352b6ddb5465d389">NO_CLASS_COPY</a> (<a class="el" href="class_file_parser.html">FileParser</a>)</td></tr>
<tr class="separator:aa22508ba901abdc8352b6ddb5465d389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd60d90d19a0b845b78e6a97a4cc8a19"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#afd60d90d19a0b845b78e6a97a4cc8a19">ParseCommands</a> (FILE *fstream)</td></tr>
<tr class="separator:afd60d90d19a0b845b78e6a97a4cc8a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5bcd49264484904f60df92e655893a6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#ae5bcd49264484904f60df92e655893a6">ParseFileFolders</a> (FILE *fstream)</td></tr>
<tr class="separator:ae5bcd49264484904f60df92e655893a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fadcdd2bc121bf2f9d82bf97b595e9f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a5fadcdd2bc121bf2f9d82bf97b595e9f">ParseProcesses</a> (FILE *fstream)</td></tr>
<tr class="separator:a5fadcdd2bc121bf2f9d82bf97b595e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a814684f4ded5f14659bdd4f2b6e86f6a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a814684f4ded5f14659bdd4f2b6e86f6a">ParseRegistry</a> (FILE *fstream)</td></tr>
<tr class="separator:a814684f4ded5f14659bdd4f2b6e86f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851ba6368db27ae7637261c63f309636"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a851ba6368db27ae7637261c63f309636">ParseServices</a> (FILE *fstream)</td></tr>
<tr class="separator:a851ba6368db27ae7637261c63f309636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17791774c8d7a3be3f82b9cea4b3be62"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a17791774c8d7a3be3f82b9cea4b3be62">ParseUninstallers</a> (FILE *fstream)</td></tr>
<tr class="separator:a17791774c8d7a3be3f82b9cea4b3be62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3efe5270b0bd6bc32b6110f2d785b3f2"><td class="memItemLeft" align="right" valign="top">wchar_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a3efe5270b0bd6bc32b6110f2d785b3f2">ReadLine</a> (FILE *fstream, wchar_t *buffer, <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> buffer_size)</td></tr>
<tr class="separator:a3efe5270b0bd6bc32b6110f2d785b3f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7d9d085e1f36606ca35091fdc85129d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#ae7d9d085e1f36606ca35091fdc85129d">RecursiveExpand</a> (const wchar_t *const source, wchar_t *dest, const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> dest_size, const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> line)</td></tr>
<tr class="separator:ae7d9d085e1f36606ca35091fdc85129d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a097fc2243080762abcb86243dbff4645"><td class="memItemLeft" align="right" valign="top">wchar_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a097fc2243080762abcb86243dbff4645">Trim</a> (wchar_t *str)</td></tr>
<tr class="separator:a097fc2243080762abcb86243dbff4645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb58172b4650cd8015d5e8cad7d29647"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#acb58172b4650cd8015d5e8cad7d29647">FileParser</a> ()</td></tr>
<tr class="separator:acb58172b4650cd8015d5e8cad7d29647"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a01a48fb6719f33f2dce2dd6adb71198f"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#a01a48fb6719f33f2dce2dd6adb71198f">mb</a> [1024]</td></tr>
<tr class="separator:a01a48fb6719f33f2dce2dd6adb71198f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6d21bebba226019e13530b08a57137"><td class="memItemLeft" align="right" valign="top">HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#abb6d21bebba226019e13530b08a57137">_token</a></td></tr>
<tr class="separator:abb6d21bebba226019e13530b08a57137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf1c4178ca8624865e2640da03b05c53"><td class="memItemLeft" align="right" valign="top">wchar_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#aaf1c4178ca8624865e2640da03b05c53">_user_path</a> [MAX_PATH]</td></tr>
<tr class="separator:aaf1c4178ca8624865e2640da03b05c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:af3d14e26ba8af9e6cc5a32aad8446de7"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_parser.html#af3d14e26ba8af9e6cc5a32aad8446de7">Runtime</a></td></tr>
<tr class="separator:af3d14e26ba8af9e6cc5a32aad8446de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>All the normal Windows environment variables are also supported automatically (such as %TMP%, %PUBLIC%, %LOGONSERVER%, etc.). In addition to these, we also support the following variables within files: </p>
<table class="doxtable">
<tr>
<td><b>Variable</b></td><td><b>Description</b></td><td><b>Example</b> </td></tr>
<tr>
<td>%SID%</td><td>The current users SID (executing the binary)</td><td>S-1-5-21-1336347285-13732138-2673565989-1002  </td></tr>
<tr>
<td>%ALLUSERS%</td><td>All user folders (i.e. not the 'All Users' folder, but for every actual user profile); excludes the system ones - 'DefaultUser', 'NetworkService', 'LocalService'...</td><td>C:\Users\ProfileName <br/>
 C:\Users\OtherProfileName  </td></tr>
<tr>
<td>%USERAPPDATA%</td><td>The path to a users Application Data folder</td><td>AppData\Roaming (Windows Vista+) <br/>
 Application Data (Windows 2000, XP)  </td></tr>
<tr>
<td></td><td></td><td></td></tr>
</table>
<p>Remember that all UI output here is done without Operations (we're in the process of populating them) - this means the output is done manually, using the same format. Errors are therefore output like: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;failed\n\t&lt;message&gt;\n&quot;</span></div>
</div><!-- fragment --><p> And success is simply: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;ok!\n&quot;</span></div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="acb58172b4650cd8015d5e8cad7d29647"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FileParser::FileParser </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8b41aca52b30e9f357f50e76f3c9cc9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FileParser::~FileParser </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a24e4c684b9ae137492fdcb5d1e14b277"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FileParser::NO_CLASS_ASSIGNMENT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_file_parser.html">FileParser</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa22508ba901abdc8352b6ddb5465d389"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FileParser::NO_CLASS_COPY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_file_parser.html">FileParser</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="afd60d90d19a0b845b78e6a97a4cc8a19"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseCommands </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses the input file stream and extracts commands to execute. This is used for pre + post installer commands, as well as the actual installers to run too. The caller will be executing these at the appropriate time.</p>
<p>Errors can be output on the fly, as and when needed, as there is no associated <a class="el" href="class_operation.html">Operation</a>. A custom failure message is required, if the parsing fails (it will silently jump straight to the application end error otherwise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fstream</td><td>A FILE stream acquired from <a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all file contents were parsed and their created operations queued </dd>
<dd>
false if a syntax error is found, or the attempt to queue a new operation for an item fails </dd></dl>

</div>
</div>
<a class="anchor" id="ae5bcd49264484904f60df92e655893a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseFileFolders </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses the input file stream and extracts file + folder paths.</p>
<p>Errors can be output on the fly, as and when needed, as there is no associated <a class="el" href="class_operation.html">Operation</a>. A custom failure message is required, if the parsing fails (it will silently jump straight to the application end error otherwise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fstream</td><td>A FILE stream acquired from <a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all file contents were parsed and their created operations queued </dd>
<dd>
false if a syntax error is found, or the attempt to queue a new operation for an item fails </dd></dl>

</div>
</div>
<a class="anchor" id="a5e9afb1f972834a822ee7f24d34281a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseInputFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_file_parser_8h.html#a77516d1e52649fa212cc16893769cf63">E_FILE_TYPE</a>&#160;</td>
          <td class="paramname"><em>filetype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filepath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calls the handler for the filetype provided, ready to generate operations for each line of content in the input file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filetype</td><td>The type of content within the input file to parse </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filepath</td><td>The relative or full path to the input file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the file is parsed successfully (or has no content) </dd>
<dd>
false if the filetype is invalid, the filepath is not found, or a syntax error prevents the file from being fully parsed. </dd></dl>

</div>
</div>
<a class="anchor" id="a5fadcdd2bc121bf2f9d82bf97b595e9f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseProcesses </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses the input file stream and extracts process names.</p>
<p>Errors can be output on the fly, as and when needed, as there is no associated <a class="el" href="class_operation.html">Operation</a>. A custom failure message is required, if the parsing fails (it will silently jump straight to the application end error otherwise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fstream</td><td>A FILE stream acquired from <a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all file contents were parsed and their created operations queued </dd>
<dd>
false if a syntax error is found, or the attempt to queue a new operation for an item fails </dd></dl>

</div>
</div>
<a class="anchor" id="a814684f4ded5f14659bdd4f2b6e86f6a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseRegistry </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses the input file stream and extracts registry keys + values.</p>
<p>Errors can be output on the fly, as and when needed, as there is no associated <a class="el" href="class_operation.html">Operation</a>. A custom failure message is required, if the parsing fails (it will silently jump straight to the application end error otherwise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fstream</td><td>A FILE stream acquired from <a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all file contents were parsed and their created operations queued </dd>
<dd>
false if a syntax error is found, or the attempt to queue a new operation for an item fails </dd></dl>

</div>
</div>
<a class="anchor" id="a851ba6368db27ae7637261c63f309636"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseServices </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses the input file stream and extracts service names.</p>
<p>Errors can be output on the fly, as and when needed, as there is no associated <a class="el" href="class_operation.html">Operation</a>. A custom failure message is required, if the parsing fails (it will silently jump straight to the application end error otherwise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fstream</td><td>A FILE stream acquired from <a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all file contents were parsed and their created operations queued </dd>
<dd>
false if a syntax error is found, or the attempt to queue a new operation for an item fails </dd></dl>

</div>
</div>
<a class="anchor" id="a17791774c8d7a3be3f82b9cea4b3be62"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::ParseUninstallers </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses the input file stream and extracts uninstallers to execute.</p>
<p>Errors can be output on the fly, as and when needed, as there is no associated <a class="el" href="class_operation.html">Operation</a>. A custom failure message is required, if the parsing fails (it will silently jump straight to the application end error otherwise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fstream</td><td>A FILE stream acquired from <a class="el" href="class_file_parser.html#a5e9afb1f972834a822ee7f24d34281a3">ParseInputFile()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all file contents were parsed and their created operations queued </dd>
<dd>
false if a syntax error is found, or the attempt to queue a new operation for an item fails </dd></dl>

</div>
</div>
<a class="anchor" id="a3efe5270b0bd6bc32b6110f2d785b3f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wchar_t * FileParser::ReadLine </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fstream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wchar_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reads the next line from the file stream.</p>
<p>Is simply a wrapper around fgetws. </p>

</div>
</div>
<a class="anchor" id="ae7d9d085e1f36606ca35091fdc85129d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FileParser::RecursiveExpand </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *const&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wchar_t *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>dest_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Fully expands the source buffer, using both our internal, and the system environment variables.</p>
<p>Used for <a class="el" href="class_file_parser.html#ae5bcd49264484904f60df92e655893a6">ParseFileFolders()</a> - not designed for the others.</p>
<p>Operations will be generated on the fly when no additional custom expansion has been performed (so nothing left to process).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">source</td><td>A nul-terminated string to expand </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest</td><td>The destination buffer to put the stored result in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_size</td><td>The size of the destination buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">line</td><td>The line of the file; used for error reporting </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>If expansion fully succeeds </td></tr>
    <tr><td class="paramname">false</td><td>If any function fails; the dest buffer will be in an indeterminate state, depending upon the point of failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>If the user has customized their profile to use non defaults (or your executing account has), then this path will be totally invalid and unusable. We wouldn't be able to find the 'real' paths without loading the profile, its hive, and querying the relevant registry value. Way too much work for a rarity.</dd></dl>

</div>
</div>
<a class="anchor" id="a097fc2243080762abcb86243dbff4645"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wchar_t * FileParser::Trim </td>
          <td>(</td>
          <td class="paramtype">wchar_t *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>str_trim, using wchar_t. Only needed for this class, so not in utils (which was written for ansi/linux sources). We also want to keep trailing spaces, which makes this totally different - this only strips newlines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">str</td><td>The string to trim whitespace (but not spaces) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the original pointer with the inserted nuls, if any newlines are found trailing. </dd></dl>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="af3d14e26ba8af9e6cc5a32aad8446de7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="class_runtime.html">Runtime</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="abb6d21bebba226019e13530b08a57137"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE FileParser::_token</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle to the current user token needed when expanding environment strings for the current user. Maintaining it for the class and not the function means we need to worry less about tracking whether or not we've released it. NULL and acquired in the constructor, release in the destructor if needed. </p>

</div>
</div>
<a class="anchor" id="aaf1c4178ca8624865e2640da03b05c53"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wchar_t FileParser::_user_path[MAX_PATH]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Like the _token, this is an acquire-once-and-forget; holds the current users profile directory, for use in variable expansion </p>

</div>
</div>
<a class="anchor" id="a01a48fb6719f33f2dce2dd6adb71198f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char FileParser::mb[1024]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>conversion local to the class; operations are prepared using char* strings (since we're not a totally Windows-centric build, most of the sources have come from cross-platform projects) </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 9 2014 00:47:25 for WinWipe by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
